<!doctype html>
<html lang="mr">

<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <meta name="description" content="Convert JPG images to WebP format with adjustable quality." />
    <meta name="keywords" content="JPG, WebP, image conversion, quality" />
    <title>JPG → WebP — RDroid Apps</title>
    <link rel="stylesheet" href="../../css/style.css">

    <!-- Include jQuery for load function -->
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
</head>

<body>
    <!-- HEADER (loaded from external file) -->
    <div id="header-container"></div>

    <!-- TOOLS QUICK LINKS (loaded from external file) -->
    <div id="tools-links-container"></div>

    <!-- MENU DRAWER (loaded from external file) -->
    <div id="menu-drawer-container"></div>

    <!-- Load all components -->
    <script>
        $(function () {
            $("#header-container").load("../../components/header.html");
            $("#menu-drawer-container").load("../../components/menu-drawer.html");
            $("#tools-links-container").load("../../components/image-tools-quick-links.html");
            $("#footer-container").load("../../components/footer.html");
        });
    </script>

    <section class="tool-section">
        <div class="card">
            <h1>JPG → WebP</h1>
            <p class="note">Quick conversion from JPG to smaller WebP.</p>

            <label class="drop" id="dropArea"
                style="height: 200px; display: flex; align-items: center; justify-content: center;">Drop image or
                <button class="btn btn-ghost" id="pickBtn">Choose file</button>
            </label>
            <input type="file" id="fileInput" accept="image/jpeg,image/jpg" />
            <div class="row">
                <div class="col"><label class="small">Quality</label><input type="range" id="quality" min="10" max="95"
                        value="80">
                    <div id="qVal">80</div>
                </div>
            </div>
            <div style="margin-top:12px;display:flex;gap:8px;">
                <button class="btn btn-primary" id="startBtn">Convert</button>
                <button class="btn btn-ghost" id="resetBtn">Reset</button>
                <a id="downloadLink" class="btn" style="display:none"></a>
            </div>
            <div id="preview" style="margin-top:12px"></div>
            <pre id="log">Ready.</pre>
            <!-- SEO Content -->
            <div id="warning" style="color:#ffb199; margin-top:8px"></div>
            <hr style="margin:32px 0">

            <section class="seo-content">
                <h2>JPG to WebP Converter — RDroidApps Pro</h2>
                <p>Welcome to the JPG to WebP converter tool by RDroidApps Pro, your go-to solution for efficient image
                    conversion. This tool is designed to help you easily convert your JPG images into the WebP format,
                    which is known for its superior compression capabilities and quality retention.</p>
                <h3>Why Convert JPG to WebP?</h3>
                <p>WebP is a modern image format that provides both lossless and lossy compression, offering smaller
                    file sizes without sacrificing quality.
                    This makes it ideal for web use where fast loading times are crucial.
                    By converting your JPG images to WebP, you can significantly reduce bandwidth usage and improve
                    website performance.</p>
                <h3>How to Use the JPG to WebP Converter</h3>
                <p>Using our JPG to WebP converter is simple and straightforward:
                <ol>
                    <li>Upload your JPG image by clicking the "Choose file" button or by dragging and dropping the file
                        into the designated area.</li>
                    <li>Adjust the quality slider to set your desired compression level. A lower quality value results
                        in a smaller file size but may affect image quality.</li>
                    <li>Click the "Convert" button to start the conversion process.</li>
                    <li>Once the conversion is complete, a download link will appear. Click it to download your new WebP
                        image.</li>
                </ol>

                </p>
                <h3>Benefits of Using RDroidApps Pro</h3>
                <p>Our JPG to WebP converter offers several benefits:
                <ul>
                    <li><strong>Ease of Use:</strong> The intuitive interface makes it easy for anyone to convert images
                        without technical knowledge.</li>
                    <li><strong>Fast Conversion:</strong> Our tool is optimized for speed, ensuring quick conversions
                        even for larger files.</li>
                    <li><strong>Quality Control:</strong> The adjustable quality setting allows you to balance between
                        image quality and file size according to your needs.</li>
                    <li><strong>No Installation Required:</strong> As a web-based tool, there is no need to download or
                        install any software.</li>
                </ul>
                </p>
                <h3>Get Started Today!</h3>
                <p>Ready to convert your JPG images to WebP? Start using the RDroidApps Pro JPG to WebP converter now
                    and experience the benefits of faster, more efficient image formats. Whether you're a web developer,
                    designer, or just someone looking to optimize their images, our tool is here to help you achieve
                    your goals with ease.</p>
            </section>
        </div>
    </section>
    <!-- FOOTER (loaded from external file) -->
    <div id="footer-container"></div>
    <script>
        function toggleMenu() { document.getElementById('drawer').classList.toggle('open') }

        // Variables declaration
        const pickBtn = document.getElementById('pickBtn'),
            fileInput = document.getElementById('fileInput'),
            dropArea = document.getElementById('dropArea'),
            quality = document.getElementById('quality'),
            qVal = document.getElementById('qVal'),
            startBtn = document.getElementById('startBtn'),
            resetBtn = document.getElementById('resetBtn'),
            downloadLink = document.getElementById('downloadLink'),
            preview = document.getElementById('preview'),
            logEl = document.getElementById('log');

        let currentFile = null;
        let originalImageURL = null;
        let webpImageURL = null;

        // Event Listeners
        pickBtn.addEventListener('click', () => fileInput.click());

        dropArea.addEventListener('dragover', e => {
            e.preventDefault();
            dropArea.style.borderColor = '#0aa37f';
            dropArea.style.background = 'rgba(10, 163, 127, 0.03)';
        });

        dropArea.addEventListener('dragleave', () => {
            dropArea.style.borderColor = '';
            dropArea.style.background = '';
        });

        dropArea.addEventListener('drop', e => {
            e.preventDefault();
            dropArea.style.borderColor = '';
            dropArea.style.background = '';

            if (e.dataTransfer.files.length) {
                fileInput.files = e.dataTransfer.files;
                fileInput.dispatchEvent(new Event('change'));
            }
        });

        quality.addEventListener('input', () => qVal.textContent = quality.value);

        fileInput.addEventListener('change', () => {
            if (fileInput.files.length === 0) return;

            currentFile = fileInput.files[0];

            // Check if file is JPG
            if (!currentFile.type.match('image/jpeg') && !currentFile.type.match('image/jpg')) {
                alert('कृपया फक्त JPG फाईल निवडा');
                fileInput.value = '';
                return;
            }

            // Release previous image URL
            if (originalImageURL) {
                URL.revokeObjectURL(originalImageURL);
            }

            originalImageURL = URL.createObjectURL(currentFile);
            preview.innerHTML = `<img src="${originalImageURL}" style="max-width:420px;border-radius:8px">`;
            logEl.textContent = `Loaded: ${currentFile.name} (${(currentFile.size / 1024).toFixed(1)} KB)`;
        });

        // Convert Function
        startBtn.addEventListener('click', () => {
            if (!currentFile) return alert('कृपया JPG निवडा');

            const reader = new FileReader();
            reader.onload = async e => {
                const img = new Image();
                img.src = e.target.result;
                await img.decode();

                const canvas = document.createElement('canvas');
                canvas.width = img.naturalWidth;
                canvas.height = img.naturalHeight;
                canvas.getContext('2d').drawImage(img, 0, 0);

                canvas.toBlob(b => {
                    // Release previous WebP image URL
                    if (webpImageURL) {
                        URL.revokeObjectURL(webpImageURL);
                    }

                    if (downloadLink.href && downloadLink.href.startsWith('blob:')) {
                        URL.revokeObjectURL(downloadLink.href);
                    }

                    webpImageURL = URL.createObjectURL(b);
                    preview.innerHTML = `<img src="${webpImageURL}" style="max-width:420px;border-radius:8px">`;

                    downloadLink.href = webpImageURL;
                    downloadLink.download = currentFile.name.replace(/\.[^/.]+$/, '') + '.webp';
                    downloadLink.textContent = 'Download';
                    downloadLink.style.display = 'inline-block';

                    const originalSize = currentFile.size / 1024;
                    const webpSize = b.size / 1024;
                    const reduction = ((1 - (webpSize / originalSize)) * 100).toFixed(1);

                    logEl.textContent = `Original JPG: ${originalSize.toFixed(1)} KB\nConverted WebP: ${webpSize.toFixed(1)} KB\nSize Reduction: ${reduction}%`;
                }, 'image/webp', parseInt(quality.value) / 100);
            }
            reader.readAsDataURL(currentFile);
        });

        // Reset Function
        resetBtn.addEventListener('click', () => {
            // Reset file input
            currentFile = null;
            fileInput.value = '';

            // Reset quality slider
            quality.value = 80;
            qVal.textContent = '80';

            // Reset UI elements
            downloadLink.style.display = 'none';
            preview.innerHTML = '';
            logEl.textContent = 'Ready.';
            dropArea.style.borderColor = '';
            dropArea.style.background = '';

            // Release all Object URLs
            if (originalImageURL) {
                URL.revokeObjectURL(originalImageURL);
                originalImageURL = null;
            }

            if (webpImageURL) {
                URL.revokeObjectURL(webpImageURL);
                webpImageURL = null;
            }

            if (downloadLink.href && downloadLink.href.startsWith('blob:')) {
                URL.revokeObjectURL(downloadLink.href);
                downloadLink.href = '#';
            }
        });
    </script>
</body>

</html>
